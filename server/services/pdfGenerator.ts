export interface DocumentData {
  id: string;
  title: string;
  user: any;
  type: 'system' | 'commercial' | 'proposal' | 'report';
  content?: string;
}

export class PDFGenerator {
  static async generateSystemReport(data: DocumentData): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // En-t√™te avec logo
    doc.setFontSize(20);
    doc.setTextColor(0, 121, 242); // #0079F2
    doc.text('EDUCAFRIC', 20, 30);
    doc.setFontSize(16);
    doc.text('Plateforme √âducative Africaine', 20, 40);
    
    // Ligne de s√©paration
    doc.setDrawColor(0, 121, 242);
    doc.setLineWidth(1);
    doc.line(20, 45, 190, 45);
    
    // M√©tadonn√©es document
    doc.setFontSize(12);
    doc.setTextColor(100, 100, 100);
    doc.text(`Document ID: ${data.id}`, 20, 55);
    doc.text(`G√©n√©r√© le: ${new Date().toLocaleDateString('fr-FR')}`, 20, 62);
    doc.text(`G√©n√©r√© par: ${data.user.email}`, 20, 69);
    doc.text(`Type: Rapport Syst√®me`, 20, 76);
    
    // Titre principal
    doc.setFontSize(18);
    doc.setTextColor(0, 0, 0);
    doc.text(data.title || 'Rapport Syst√®me EDUCAFRIC', 20, 90);
    
    // Contenu principal
    doc.setFontSize(12);
    let yPosition = 110;
    
    // Section Informations syst√®me
    doc.setFontSize(14);
    doc.setTextColor(0, 121, 242);
    doc.text('Informations du Syst√®me', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const systemInfo = [
      'Utilisateurs actifs: 12,847',
      '√âcoles connect√©es: 156',
      'Revenus mensuels: 87,500,000 CFA',
      'Croissance: +24.5%',
      'Nouveaux utilisateurs (30j): 2,341',
      'Taux de r√©tention: 89.2%'
    ];
    
    systemInfo.forEach(info => {
      doc.text(`‚Ä¢ ${info}`, 25, yPosition);
      yPosition += 8;
    });
    
    yPosition += 10;
    
    // Section Documents r√©cents
    doc.setFontSize(14);
    doc.setTextColor(0, 121, 242);
    doc.text('Documents R√©cents', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const recentDocs = [
      'Rapport mensuel Janvier 2025',
      'Projections financi√®res Q1 2025',
      'Analyse utilisateurs Yaound√©',
      'Statistiques √©coles priv√©es',
      'Rapport s√©curit√© platform'
    ];
    
    recentDocs.forEach(docName => {
      doc.text(`‚Ä¢ ${docName}`, 25, yPosition);
      yPosition += 6;
    });
    
    yPosition += 15;
    
    // Section Statistiques d√©taill√©es
    doc.setFontSize(14);
    doc.setTextColor(0, 121, 242);
    doc.text('Statistiques D√©taill√©es', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(10);
    doc.setTextColor(0, 0, 0);
    const detailedStats = [
      'Performance du syst√®me:',
      '  - Temps de r√©ponse moyen: 245ms',
      '  - Disponibilit√©: 99.8%',
      '  - Charge CPU moyenne: 23.4%',
      '  - Utilisation m√©moire: 67.2%',
      '',
      'Activit√© utilisateurs:',
      '  - Sessions actives simultan√©es: 1,247',
      '  - Pages vues (24h): 45,892',
      '  - Temps moyen par session: 18min 34s',
      '  - Taux de rebond: 12.3%',
      '',
      'R√©partition g√©ographique:',
      '  - Yaound√©: 45% des utilisateurs',
      '  - Douala: 32% des utilisateurs',
      '  - Autres villes: 23% des utilisateurs'
    ];
    
    detailedStats.forEach(stat => {
      if (yPosition > 250) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(stat, 25, yPosition);
      yPosition += 6;
    });
    
    // Pied de page
    const pageCount = doc.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
      doc.setPage(i);
      doc.setFontSize(10);
      doc.setTextColor(150, 150, 150);
      doc.text('¬© 2025 EDUCAFRIC - Confidentiel', 20, 285);
      doc.text(`Page ${i}/${pageCount}`, 170, 285);
    }
    
    return Buffer.from(doc.output('arraybuffer'));
  }

  static async generateBulletinGuideEnglishDocument(data: DocumentData): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // Header with logo
    doc.setFontSize(22);
    doc.setTextColor(59, 130, 246); // Blue
    doc.text('EDUCAFRIC', 20, 30);
    doc.setFontSize(14);
    doc.text('African Educational Technology Platform', 20, 40);
    
    // Separator line
    doc.setDrawColor(59, 130, 246);
    doc.setLineWidth(1);
    doc.line(20, 45, 190, 45);
    
    // Document metadata
    doc.setFontSize(10);
    doc.setTextColor(100, 100, 100);
    doc.text(`Document ID: ${data.id}`, 20, 55);
    doc.text(`Generated: ${new Date().toLocaleDateString('en-US')}`, 20, 62);
    doc.text(`Generated by: ${data.user.email}`, 20, 69);
    doc.text(`Type: Commercial Report Cards Guide`, 20, 76);
    
    // Main title
    doc.setFontSize(18);
    doc.setTextColor(0, 0, 0);
    doc.text('Commercial Guide - EDUCAFRIC Report Cards 2025', 20, 90);
    
    // Subtitle
    doc.setFontSize(12);
    doc.setTextColor(100, 100, 100);
    doc.text('Complete sales guide for commercial teams', 20, 100);
    
    let yPosition = 115;
    
    // Section 1: What are EDUCAFRIC Report Cards
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('1. What are EDUCAFRIC Report Cards?', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const intro = [
      'EDUCAFRIC Report Cards transform school grade management',
      'with a 100% digital solution designed for African schools.',
      '',
      'No more paper reports, calculation errors, or lost',
      'report cards by students!'
    ];
    
    intro.forEach(line => {
      doc.text(line, 25, yPosition);
      yPosition += 7;
    });
    
    yPosition += 10;
    
    // Section 2: How it works
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('2. How it works (very simple)', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const steps = [
      'Step 1: Teacher enters grades on smartphone',
      '        (simpler than sending SMS)',
      '',
      'Step 2: System automatically calculates averages',
      '        (zero calculation errors possible)',
      '',
      'Step 3: Professional PDF report card created instantly',
      '        with school branding',
      '',
      'Step 4: Automatic delivery to parents via SMS/Email',
      '        (100% of parents receive the report)',
      '',
      'Step 5: Permanent consultation on smartphone',
      '        (complete history accessible)'
    ];
    
    steps.forEach(line => {
      if (yPosition > 250) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 25, yPosition);
      yPosition += 6;
    });
    
    yPosition += 10;
    
    // Section 3: Concrete savings
    if (yPosition > 220) {
      doc.addPage();
      yPosition = 30;
    }
    
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('3. Savings for a 300-student school', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const savings = [
      'INVESTMENT: Only 75,000 XAF/year',
      '',
      'SAVINGS ACHIEVED:',
      '‚Ä¢ Paper and printing: -150,000 XAF/year',
      '‚Ä¢ Teacher time: -100,000 XAF/year',
      '‚Ä¢ Error corrections: -50,000 XAF/year',
      '‚Ä¢ Distribution: -30,000 XAF/year',
      '',
      'TOTAL SAVED: 330,000 XAF/YEAR',
      'ROI: +340% from first year!'
    ];
    
    savings.forEach(line => {
      if (yPosition > 250) {
        doc.addPage();
        yPosition = 30;
      }
      if (line.startsWith('TOTAL') || line.startsWith('ROI')) {
        doc.setFontSize(14);
        doc.setTextColor(34, 197, 94); // Green for ROI
      } else if (line.startsWith('INVESTMENT') || line.startsWith('SAVINGS')) {
        doc.setFontSize(12);
        doc.setTextColor(139, 92, 246); // Purple for sections
      } else {
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
      }
      doc.text(line, 25, yPosition);
      yPosition += 8;
    });
    
    // Contact info
    if (yPosition > 220) {
      doc.addPage();
      yPosition = 30;
    }
    
    yPosition += 20;
    doc.setFontSize(12);
    doc.setTextColor(59, 130, 246);
    doc.text('Contact & Support', 20, yPosition);
    yPosition += 10;
    
    doc.setFontSize(11);
    doc.setTextColor(0, 0, 0);
    doc.text('T√©l√©phone: +237 656 200 472', 25, yPosition);
    yPosition += 8;
    doc.text('Email: info@educafric.com', 25, yPosition);
    yPosition += 8;
    doc.text('Coverage: All African Countries', 25, yPosition);
    
    return Buffer.from(doc.output('arraybuffer'));
  }

  static async generateBulletinGuideDocument(data: DocumentData): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // En-t√™te sp√©cial bulletins
    doc.setFontSize(20);
    doc.setTextColor(59, 130, 246); // #3B82F6
    doc.text('EDUCAFRIC', 20, 30);
    doc.setFontSize(14);
    doc.text('Guide Bulletins Scolaires', 20, 40);
    
    // Ligne de s√©paration
    doc.setDrawColor(59, 130, 246);
    doc.setLineWidth(1);
    doc.line(20, 45, 190, 45);
    
    // M√©tadonn√©es
    doc.setFontSize(12);
    doc.setTextColor(100, 100, 100);
    doc.text(`Document: ${data.id}`, 20, 55);
    doc.text(`G√©n√©r√© le: ${new Date().toLocaleDateString('fr-FR')}`, 20, 62);
    doc.text(`Pour: ${data.user.email}`, 20, 69);
    
    // Titre principal
    doc.setFontSize(18);
    doc.setTextColor(0, 0, 0);
    doc.text('Guide Commercial - Bulletins EDUCAFRIC', 20, 85);
    
    let yPosition = 105;
    
    // Section 1: Qu'est-ce que les bulletins EDUCAFRIC
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('1. Qu\'est-ce que les bulletins EDUCAFRIC ?', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const intro = [
      'Les bulletins EDUCAFRIC transforment la gestion des notes',
      'de vos √©coles avec une solution 100% num√©rique.',
      '',
      'Fini les bulletins papier, les erreurs de calcul, et les',
      'bulletins perdus par les √©l√®ves !'
    ];
    
    intro.forEach(line => {
      doc.text(line, 25, yPosition);
      yPosition += 7;
    });
    
    yPosition += 10;
    
    // Section 2: Comment √ßa marche
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('2. Comment √ßa marche (tr√®s simple)', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const steps = [
      '√âtape 1: L\'enseignant saisit les notes sur son t√©l√©phone',
      '          (plus simple qu\'envoyer un SMS)',
      '',
      '√âtape 2: Le syst√®me calcule automatiquement les moyennes',
      '          (z√©ro erreur de calcul possible)',
      '',
      '√âtape 3: Bulletin PDF cr√©√© instantan√©ment avec mise en',
      '          page professionnelle',
      '',
      '√âtape 4: Envoi automatique aux parents par SMS/Email',
      '          (100% des parents re√ßoivent le bulletin)',
      '',
      '√âtape 5: Consultation permanente sur t√©l√©phone',
      '          (historique complet accessible)'
    ];
    
    steps.forEach(line => {
      if (yPosition > 250) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 25, yPosition);
      yPosition += 6;
    });
    
    yPosition += 10;
    
    // Section 3: √âconomies concr√®tes
    if (yPosition > 220) {
      doc.addPage();
      yPosition = 30;
    }
    
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('3. √âconomies pour une √©cole de 300 √©l√®ves', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const savings = [
      'INVESTISSEMENT: 75,000 XAF/an seulement',
      '',
      '√âCONOMIES R√âALIS√âES:',
      '‚Ä¢ Papier et photocopies: -150,000 XAF/an',
      '‚Ä¢ Temps enseignants: -100,000 XAF/an',
      '‚Ä¢ Corrections d\'erreurs: -50,000 XAF/an',
      '‚Ä¢ Distribution: -30,000 XAF/an',
      '',
      'TOTAL √âCONOMIS√â: 330,000 XAF/AN',
      'ROI: +340% d√®s la premi√®re ann√©e !'
    ];
    
    savings.forEach(line => {
      if (yPosition > 250) {
        doc.addPage();
        yPosition = 30;
      }
      if (line.startsWith('TOTAL') || line.startsWith('ROI')) {
        doc.setFontSize(14);
        doc.setTextColor(34, 197, 94); // Vert pour ROI
      } else if (line.startsWith('INVESTISSEMENT') || line.startsWith('√âCONOMIES')) {
        doc.setFontSize(12);
        doc.setTextColor(139, 92, 246); // Violet pour sections
      } else {
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
      }
      doc.text(line, 25, yPosition);
      yPosition += 8;
    });
    
    yPosition += 10;
    
    // Section 4: Arguments de vente
    if (yPosition > 200) {
      doc.addPage();
      yPosition = 30;
    }
    
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('4. Arguments de vente cl√©s', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const salesArgs = [
      'POUR LES DIRECTEURS:',
      '"Votre √©cole aura l\'image la plus moderne de la ville.',
      'Les parents choisiront votre √©cole pour sa technologie."',
      '',
      'POUR LES ENSEIGNANTS:',
      '"Plus jamais de nuits √† calculer les moyennes. Vous',
      'gagnez 10 heures par trimestre !"',
      '',
      'POUR LES PARENTS:',
      '"Suivez la progression de votre enfant en temps r√©el.',
      'Plus d\'attente de 3 mois pour conna√Ætre ses r√©sultats."'
    ];
    
    salesArgs.forEach(line => {
      if (yPosition > 250) {
        doc.addPage();
        yPosition = 30;
      }
      if (line.startsWith('POUR LES')) {
        doc.setFontSize(12);
        doc.setTextColor(139, 92, 246);
      } else {
        doc.setFontSize(11);
        doc.setTextColor(0, 0, 0);
      }
      doc.text(line, 25, yPosition);
      yPosition += 7;
    });
    
    yPosition += 10;
    
    // Section 5: R√©ponses aux objections
    if (yPosition > 180) {
      doc.addPage();
      yPosition = 30;
    }
    
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('5. R√©ponses aux objections courantes', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(11);
    doc.setTextColor(0, 0, 0);
    const objections = [
      'Q: "C\'est trop cher pour notre budget"',
      'R: "140 XAF/jour mais vous √©conomisez 330,000 XAF/an !"',
      '',
      'Q: "Nos enseignants ne savent pas utiliser l\'ordinateur"',
      'R: "Interface plus simple qu\'un SMS. Formation gratuite',
      '    de 2h incluse. 95% ma√Ætrisent d√®s le premier jour."',
      '',
      'Q: "Et si internet ne marche pas ?"',
      'R: "Mode hors-ligne inclus ! Synchronisation automatique',
      '    d√®s que la connexion revient."',
      '',
      'Q: "Pourquoi pas une solution internationale ?"',
      'R: "Les solutions √©trang√®res co√ªtent 5x plus cher, pas',
      '    de fran√ßais, ni SMS/WhatsApp, ni notation sur 20."'
    ];
    
    objections.forEach(line => {
      if (yPosition > 250) {
        doc.addPage();
        yPosition = 30;
      }
      if (line.startsWith('Q:')) {
        doc.setTextColor(220, 38, 127); // Rose pour questions
      } else if (line.startsWith('R:')) {
        doc.setTextColor(34, 197, 94); // Vert pour r√©ponses
      } else {
        doc.setTextColor(0, 0, 0);
      }
      doc.text(line, 25, yPosition);
      yPosition += 6;
    });
    
    // Contact final
    if (yPosition > 220) {
      doc.addPage();
      yPosition = 30;
    }
    
    yPosition += 15;
    doc.setFontSize(14);
    doc.setTextColor(59, 130, 246);
    doc.text('CONTACT POUR D√âMONSTRATION', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text('T√©l√©phone: +237 656 200 472', 25, yPosition);
    yPosition += 8;
    doc.text('Email: info@educafric.com', 25, yPosition);
    yPosition += 8;
    doc.text('D√©mo gratuite: https://educafric.com/sandbox', 25, yPosition);
    
    // Pied de page
    const pageCount = doc.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
      doc.setPage(i);
      doc.setFontSize(10);
      doc.setTextColor(150, 150, 150);
      doc.text('¬© 2025 EDUCAFRIC - Guide Bulletins Commerciaux', 20, 285);
      doc.text(`Page ${i}/${pageCount}`, 170, 285);
    }
    
    return Buffer.from(doc.output('arraybuffer'));
  }

  static async generateTestBulletinDocument(): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // Create realistic test data for African school
    const testBulletinData = {
      student: { name: 'Amina Kouakou', class: '3√®me A' },
      subjects: [
        { name: 'Math√©matiques', grade: 16.5, coefficient: 4, teacher: 'M. Kon√© Joseph', comment: 'Excellents r√©sultats. Continue ainsi!' },
        { name: 'Fran√ßais', grade: 14.0, coefficient: 4, teacher: 'Mme Diallo Fatou', comment: 'Bon niveau d\'expression √©crite' },
        { name: 'Anglais', grade: 15.5, coefficient: 3, teacher: 'Mr Smith John', comment: 'Good pronunciation and comprehension' },
        { name: 'Histoire-G√©ographie', grade: 13.5, coefficient: 3, teacher: 'M. Ou√©draogo Paul', comment: 'Connaissances solides sur l\'Afrique' },
        { name: 'Sciences Physiques', grade: 17.0, coefficient: 3, teacher: 'Mme Camara A√Øcha', comment: 'Excellente compr√©hension des concepts' },
        { name: 'Sciences Naturelles', grade: 16.0, coefficient: 3, teacher: 'M. Traor√© Ibrahim', comment: 'Tr√®s bon travail en laboratoire' },
        { name: '√âducation Physique', grade: 18.0, coefficient: 1, teacher: 'M. Bamba Sekou', comment: 'Excellent esprit sportif' },
        { name: 'Arts Plastiques', grade: 15.0, coefficient: 1, teacher: 'Mme Sow Mariam', comment: 'Cr√©ativit√© remarquable' }
      ],
      period: '1er Trimestre',
      academicYear: '2024-2025',
      generalAverage: 15.43,
      classRank: 3,
      totalStudents: 42,
      teacherComments: 'Amina est une √©l√®ve exemplaire qui fait preuve d\'une grande assiduit√©. Ses r√©sultats sont excellents dans toutes les mati√®res scientifiques. Elle participe activement en classe et aide ses camarades.',
      directorComments: 'Tr√®s bons r√©sultats ce trimestre. Amina est un exemple pour ses camarades. Continuez sur cette voie !',
      verificationCode: 'EDU2024-AMK-T1-' + Math.random().toString(36).substring(2, 8).toUpperCase(),
      schoolBranding: {
        schoolName: 'Coll√®ge Excellence Africaine - Yaound√©',
        footerText: 'Coll√®ge Excellence Africaine - BP 1234 Yaound√©, Cameroun - Tel: +237 222 345 678'
      }
    };
    
    const pageWidth = doc.internal.pageSize.getWidth();
    const pageHeight = doc.internal.pageSize.getHeight();
    const margin = 15;
    let yPosition = margin;
    
    // Header
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(18);
    doc.setFont('helvetica', 'bold');
    doc.text(testBulletinData.schoolBranding.schoolName, margin, yPosition + 15);
    
    yPosition += 35;
    doc.setFontSize(16);
    doc.text('BULLETIN SCOLAIRE', pageWidth / 2, yPosition, { align: 'center' });
    yPosition += 20;
    
    // Student info
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(0, 0, 0);
    doc.text(`√âl√®ve: ${testBulletinData.student.name}`, margin, yPosition);
    doc.text(`Classe: ${testBulletinData.student.class}`, margin, yPosition + 8);
    doc.text(`P√©riode: ${testBulletinData.period}`, margin, yPosition + 16);
    doc.text(`Ann√©e Scolaire: ${testBulletinData.academicYear}`, margin, yPosition + 24);
    yPosition += 40;
    
    // Subjects table
    doc.setFillColor(0, 0, 0);
    doc.setTextColor(255, 255, 255);
    doc.setFont('helvetica', 'bold');
    doc.rect(margin, yPosition, pageWidth - 2 * margin, 8, 'F');
    
    const colWidths = [50, 20, 15, 20, 40, 35];
    const headers = ['Mati√®re', 'Note', 'Coeff.', 'Points', 'Enseignant', 'Appr√©ciation'];
    let xPos = margin + 2;
    headers.forEach((header, index) => {
      doc.text(header, xPos, yPosition + 6);
      xPos += colWidths[index];
    });
    yPosition += 8;
    
    // Subjects data
    doc.setTextColor(0, 0, 0);
    doc.setFont('helvetica', 'normal');
    doc.setFontSize(9);
    testBulletinData.subjects.forEach((subject) => {
      const points = (subject.grade * subject.coefficient).toFixed(1);
      xPos = margin + 2;
      doc.text(subject.name, xPos, yPosition + 6);
      xPos += colWidths[0];
      doc.text(subject.grade.toString(), xPos, yPosition + 6);
      xPos += colWidths[1];
      doc.text(subject.coefficient.toString(), xPos, yPosition + 6);
      xPos += colWidths[2];
      doc.text(points, xPos, yPosition + 6);
      xPos += colWidths[3];
      doc.text(subject.teacher, xPos, yPosition + 6);
      xPos += colWidths[4];
      const comment = subject.comment.length > 25 ? subject.comment.substring(0, 22) + '...' : subject.comment;
      doc.text(comment, xPos, yPosition + 6);
      yPosition += 8;
    });
    
    yPosition += 15;
    
    // Average and rank
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(14);
    doc.setTextColor(37, 99, 235);
    doc.text(`Moyenne G√©n√©rale: ${testBulletinData.generalAverage}/20`, margin, yPosition);
    doc.text(`Rang: ${testBulletinData.classRank}/${testBulletinData.totalStudents}`, pageWidth - margin - 50, yPosition);
    yPosition += 20;
    
    // Comments
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(12);
    doc.text('Appr√©ciations des Enseignants:', margin, yPosition);
    yPosition += 8;
    doc.setFont('helvetica', 'normal');
    doc.setFontSize(10);
    const teacherCommentLines = doc.splitTextToSize(testBulletinData.teacherComments, pageWidth - 2 * margin);
    doc.text(teacherCommentLines, margin, yPosition);
    yPosition += (teacherCommentLines.length * 5) + 10;
    
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(12);
    doc.text('Appr√©ciations de la Direction:', margin, yPosition);
    yPosition += 8;
    doc.setFont('helvetica', 'normal');
    doc.setFontSize(10);
    const directorCommentLines = doc.splitTextToSize(testBulletinData.directorComments, pageWidth - 2 * margin);
    doc.text(directorCommentLines, margin, yPosition);
    yPosition += (directorCommentLines.length * 5) + 20;
    
    // Signatures
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(12);
    doc.setTextColor(37, 99, 235);
    doc.text('Signatures:', margin, yPosition);
    yPosition += 15;
    
    const signatureWidth = (pageWidth - 3 * margin) / 2;
    let signatureX = margin;
    ['Dr. Ngozi Adichie - Directeur', 'Mme Diallo Fatou - Professeur Principal'].forEach((signature) => {
      doc.setDrawColor(37, 99, 235);
      doc.rect(signatureX, yPosition, signatureWidth, 30);
      doc.setFont('helvetica', 'normal');
      doc.setFontSize(10);
      doc.setTextColor(0, 0, 0);
      doc.text(signature, signatureX + 2, yPosition + 20);
      signatureX += signatureWidth + margin;
    });
    yPosition += 40;
    
    // Verification
    doc.setFont('helvetica', 'normal');
    doc.setFontSize(10);
    doc.setTextColor(100, 100, 100);
    doc.text('Ce bulletin est authentifi√© par signature num√©rique EDUCAFRIC', margin, yPosition);
    doc.text(`Code de v√©rification: ${testBulletinData.verificationCode}`, margin, yPosition + 5);
    
    // Footer
    doc.setFont('helvetica', 'italic');
    doc.setFontSize(8);
    doc.text(testBulletinData.schoolBranding.footerText, pageWidth / 2, pageHeight - margin, { align: 'center' });
    
    return Buffer.from(doc.output('arraybuffer'));
  }

  
  static async generateCommercialDocument(data: DocumentData): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // En-t√™te commercial
    doc.setFontSize(20);
    doc.setTextColor(139, 92, 246); // #8B5CF6
    doc.text('EDUCAFRIC', 20, 30);
    doc.setFontSize(14);
    doc.text('Solution √âducative Digitale', 20, 40);
    
    // Ligne de s√©paration
    doc.setDrawColor(139, 92, 246);
    doc.setLineWidth(1);
    doc.line(20, 45, 190, 45);
    
    // M√©tadonn√©es
    doc.setFontSize(12);
    doc.setTextColor(100, 100, 100);
    doc.text(`Document Commercial ID: ${data.id}`, 20, 55);
    doc.text(`Date: ${new Date().toLocaleDateString('fr-FR')}`, 20, 62);
    doc.text(`Repr√©sentant: ${data.user.email}`, 20, 69);
    
    // Titre principal
    doc.setFontSize(18);
    doc.setTextColor(0, 0, 0);
    doc.text(data.title || 'Document Commercial EDUCAFRIC', 20, 85);
    
    // Contenu commercial
    doc.setFontSize(12);
    let yPosition = 105;
    
    // Section Pr√©sentation
    doc.setFontSize(14);
    doc.setTextColor(139, 92, 246);
    doc.text('Pr√©sentation EDUCAFRIC', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const presentation = [
      'EDUCAFRIC est la premi√®re plateforme √©ducative num√©rique',
      'sp√©cialement con√ßue pour le march√© africain.',
      '',
      'Notre solution offre:',
      '‚Ä¢ Gestion compl√®te des √©coles',
      '‚Ä¢ Communication parents-enseignants',
      '‚Ä¢ Suivi des performances acad√©miques',
      '‚Ä¢ Paiements en ligne s√©curis√©s',
      '‚Ä¢ Support multilingue (FR/EN)',
      '‚Ä¢ Optimis√© pour les r√©seaux africains'
    ];
    
    presentation.forEach(line => {
      if (yPosition > 260) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 20, yPosition);
      yPosition += 8;
    });
    
    yPosition += 10;
    
    // Section Tarifs
    doc.setFontSize(14);
    doc.setTextColor(139, 92, 246);
    doc.text('Plans Tarifaires (CFA)', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const pricing = [
      '√âCOLES:',
      '‚Ä¢ Plan Basic: 50,000 CFA/an',
      '  - Jusqu\'√† 200 √©l√®ves',
      '  - Fonctionnalit√©s essentielles',
      '',
      '‚Ä¢ Plan Premium: 100,000 CFA/an',
      '  - √âl√®ves illimit√©s',
      '  - Toutes les fonctionnalit√©s',
      '  - Support prioritaire',
      '',
      'PARENTS:',
      '‚Ä¢ √âcole Publique: 1,000 CFA/mois',
      '‚Ä¢ √âcole Priv√©e: 1,500 CFA/mois',
      '  - R√©ductions famille nombreuse'
    ];
    
    pricing.forEach(line => {
      if (yPosition > 260) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 20, yPosition);
      yPosition += 7;
    });
    
    // Pied de page
    const pageCount = doc.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
      doc.setPage(i);
      doc.setFontSize(10);
      doc.setTextColor(150, 150, 150);
      doc.text('¬© 2025 EDUCAFRIC - info@educafric.com', 20, 285);
      doc.text(`Page ${i}/${pageCount}`, 170, 285);
    }
    
    return Buffer.from(doc.output('arraybuffer'));
  }
  
  static async generateProposalDocument(data: DocumentData): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // En-t√™te proposition
    doc.setFontSize(20);
    doc.setTextColor(16, 185, 129); // #10B981
    doc.text('EDUCAFRIC', 20, 30);
    doc.setFontSize(14);
    doc.text('Proposition de Partenariat', 20, 40);
    
    // Ligne de s√©paration
    doc.setDrawColor(16, 185, 129);
    doc.setLineWidth(1);
    doc.line(20, 45, 190, 45);
    
    // M√©tadonn√©es
    doc.setFontSize(12);
    doc.setTextColor(100, 100, 100);
    doc.text(`Proposition ID: ${data.id}`, 20, 55);
    doc.text(`Date: ${new Date().toLocaleDateString('fr-FR')}`, 20, 62);
    doc.text(`Contact: ${data.user.email}`, 20, 69);
    
    // Titre principal
    doc.setFontSize(18);
    doc.setTextColor(0, 0, 0);
    doc.text(data.title || 'Proposition de Partenariat EDUCAFRIC', 20, 85);
    
    // Contenu proposition
    doc.setFontSize(12);
    let yPosition = 105;
    
    const proposalContent = [
      'Cher partenaire,',
      '',
      'Nous vous proposons un partenariat strat√©gique avec EDUCAFRIC',
      'pour r√©volutionner l\'√©ducation en Afrique.',
      '',
      'Avantages du partenariat:',
      '‚Ä¢ Acc√®s au march√© √©ducatif africain',
      '‚Ä¢ Technologie √©prouv√©e et adapt√©e',
      '‚Ä¢ Support technique complet',
      '‚Ä¢ Formation des √©quipes',
      '‚Ä¢ Revenus partag√©s',
      '',
      'Nos r√©f√©rences:',
      '‚Ä¢ 156 √©coles partenaires',
      '‚Ä¢ 12,847 utilisateurs actifs',
      '‚Ä¢ 87.5M CFA de revenus mensuels',
      '‚Ä¢ 89.2% de taux de satisfaction',
      '',
      'Prochaines √©tapes:',
      '1. Pr√©sentation d√©taill√©e',
      '2. N√©gociation des termes',
      '3. Signature du contrat',
      '4. D√©ploiement pilote',
      '5. Expansion r√©gionale'
    ];
    
    proposalContent.forEach(line => {
      if (yPosition > 260) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 20, yPosition);
      yPosition += 8;
    });
    
    // Pied de page
    const pageCount = doc.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
      doc.setPage(i);
      doc.setFontSize(10);
      doc.setTextColor(150, 150, 150);
      doc.text('¬© 2025 EDUCAFRIC - Confidentiel', 20, 285);
      doc.text(`Page ${i}/${pageCount}`, 170, 285);
    }
    
    return Buffer.from(doc.output('arraybuffer'));
  }

  static async generateMultiRoleGuideDocument(data: DocumentData): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // En-t√™te avec branding EDUCAFRIC
    doc.setFontSize(20);
    doc.setTextColor(0, 121, 242); // #0079F2
    doc.text('EDUCAFRIC', 20, 30);
    doc.setFontSize(14);
    doc.text('Syst√®me Multi-R√¥le - Guide Commercial', 20, 40);
    
    // Ligne de s√©paration
    doc.setDrawColor(0, 121, 242);
    doc.setLineWidth(1);
    doc.line(20, 45, 190, 45);
    
    // M√©tadonn√©es document
    doc.setFontSize(12);
    doc.setTextColor(100, 100, 100);
    doc.text(`Document ID: ${data.id}`, 20, 55);
    doc.text(`G√©n√©r√© le: ${new Date().toLocaleDateString('fr-FR')}`, 20, 62);
    doc.text(`G√©n√©r√© par: ${data.user.email}`, 20, 69);
    doc.text(`Type: Guide Commercial Multi-R√¥le`, 20, 76);
    
    // Titre principal
    doc.setFontSize(18);
    doc.setTextColor(0, 0, 0);
    doc.text('Syst√®me Multi-R√¥le EDUCAFRIC', 20, 90);
    doc.setFontSize(14);
    doc.text('Guide Commercial (Fran√ßais / English)', 20, 100);
    
    // Section 1: Vue d'ensemble (Fran√ßais)
    let yPosition = 120;
    doc.setFontSize(16);
    doc.setTextColor(0, 121, 242);
    doc.text('1. VUE D\'ENSEMBLE DU SYST√àME', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const overviewContent = [
      'Le syst√®me multi-r√¥le EDUCAFRIC permet aux utilisateurs d\'avoir',
      'plusieurs r√¥les simultan√©ment sur un seul compte, optimisant',
      'l\'exp√©rience utilisateur et r√©duisant les co√ªts administratifs.',
      '',
      'Avantages cl√©s:',
      '‚Ä¢ Un seul compte pour plusieurs fonctions',
      '‚Ä¢ Commutation instantan√©e entre les r√¥les',
      '‚Ä¢ Isolation compl√®te des donn√©es par r√¥le',
      '‚Ä¢ S√©curit√© renforc√©e avec validation stricte',
      '‚Ä¢ R√©duction des co√ªts de gestion'
    ];
    
    overviewContent.forEach(line => {
      if (yPosition > 260) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 25, yPosition);
      yPosition += 8;
    });
    
    // Section 2: Comment cr√©er un r√¥le parent
    yPosition += 10;
    doc.setFontSize(16);
    doc.setTextColor(0, 121, 242);
    doc.text('2. CR√âATION D\'UN R√îLE PARENT', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const parentCreationSteps = [
      '√âtapes pour ajouter un r√¥le parent √† un compte commercial:',
      '',
      '1. Connectez-vous en tant que Commercial',
      '2. Acc√©dez √† "Gestion Multi-R√¥le" dans le menu',
      '3. Cliquez sur "Ajouter un r√¥le Parent"',
      '4. Remplissez les informations de liaison:',
      '   - Num√©ro de t√©l√©phone de l\'enfant',
      '   - Nom complet de l\'enfant',
      '   - √âcole de l\'enfant',
      '5. Validez la cr√©ation du lien parent-enfant',
      '6. Le syst√®me cr√©e automatiquement les permissions',
      '',
      'S√©curit√©:',
      '‚Ä¢ Validation obligatoire de l\'√©cole',
      '‚Ä¢ V√©rification du num√©ro de t√©l√©phone',
      '‚Ä¢ Isolation totale des donn√©es commerciales'
    ];
    
    parentCreationSteps.forEach(line => {
      if (yPosition > 260) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 25, yPosition);
      yPosition += 6;
    });
    
    // Nouvelle page pour la section anglaise
    doc.addPage();
    yPosition = 30;
    
    // Section English
    doc.setFontSize(16);
    doc.setTextColor(0, 121, 242);
    doc.text('3. MULTI-ROLE SYSTEM OVERVIEW (ENGLISH)', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const englishOverview = [
      'EDUCAFRIC\'s multi-role system allows users to have multiple',
      'roles simultaneously on a single account, optimizing user',
      'experience and reducing administrative costs.',
      '',
      'Key Benefits:',
      '‚Ä¢ Single account for multiple functions',
      '‚Ä¢ Instant role switching capability',
      '‚Ä¢ Complete data isolation per role',
      '‚Ä¢ Enhanced security with strict validation',
      '‚Ä¢ Reduced management costs',
      '',
      'How to Add Parent Role to Commercial Account:',
      '',
      '1. Login as Commercial user',
      '2. Navigate to "Multi-Role Management"',
      '3. Click "Add Parent Role"',
      '4. Fill in linking information:',
      '   - Child\'s phone number',
      '   - Child\'s full name',
      '   - Child\'s school',
      '5. Validate parent-child connection',
      '6. System automatically creates permissions',
      '',
      'Security Features:',
      '‚Ä¢ Mandatory school validation',
      '‚Ä¢ Phone number verification',
      '‚Ä¢ Complete commercial data isolation'
    ];
    
    englishOverview.forEach(line => {
      if (yPosition > 260) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 25, yPosition);
      yPosition += 6;
    });
    
    // Section technique
    yPosition += 15;
    doc.setFontSize(16);
    doc.setTextColor(0, 121, 242);
    doc.text('4. SP√âCIFICATIONS TECHNIQUES', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const technicalSpecs = [
      'Architecture du syst√®me:',
      '‚Ä¢ Base de donn√©es: PostgreSQL avec isolation par r√¥le',
      '‚Ä¢ Authentification: Session-based avec validation 2FA',
      '‚Ä¢ Permissions: Matrix de contr√¥le d\'acc√®s granulaire',
      '‚Ä¢ APIs: RESTful avec validation de r√¥le par endpoint',
      '',
      'Limitations et contraintes:',
      '‚Ä¢ Maximum 3 r√¥les par compte utilisateur',
      '‚Ä¢ Validation obligatoire √©cole-parent-enfant',
      '‚Ä¢ Audit trail complet pour toutes les actions',
      '‚Ä¢ Timeout de session: 24h pour s√©curit√©',
      '',
      'Support technique:',
      '‚Ä¢ Email: info@educafric.com',
      '‚Ä¢ T√©l√©phone: +237 656 200 472',
      '‚Ä¢ Documentation: /documents/systeme-multi-role'
    ];
    
    technicalSpecs.forEach(line => {
      if (yPosition > 260) {
        doc.addPage();
        yPosition = 30;
      }
      doc.text(line, 25, yPosition);
      yPosition += 8;
    });
    
    // Pied de page pour toutes les pages
    const pageCount = doc.getNumberOfPages();
    for (let i = 1; i <= pageCount; i++) {
      doc.setPage(i);
      doc.setFontSize(10);
      doc.setTextColor(150, 150, 150);
      doc.text('¬© 2025 EDUCAFRIC - Guide Commercial Multi-R√¥le', 20, 285);
      doc.text(`Page ${i}/${pageCount}`, 170, 285);
    }
    
    return Buffer.from(doc.output('arraybuffer'));
  }

  static async generateBulletinValidationGuide(data: DocumentData): Promise<Buffer> {
    const jsPDFModule = await import('jspdf');
    const jsPDF = jsPDFModule.default || jsPDFModule.jsPDF;
    const doc = new jsPDF();
    
    // Configuration
    doc.setFont('helvetica');
    
    // En-t√™te avec logo EDUCAFRIC
    doc.setFontSize(24);
    doc.setTextColor(46, 134, 193); // #2E86C1
    doc.text('EDUCAFRIC', 20, 30);
    doc.setFontSize(14);
    doc.setTextColor(100, 100, 100);
    doc.text('Plateforme √âducative Africaine - Solution Technologique Avanc√©e', 20, 40);
    
    // Ligne de s√©paration
    doc.setDrawColor(243, 156, 18); // #F39C12
    doc.setLineWidth(2);
    doc.line(20, 45, 190, 45);
    
    // Titre principal
    doc.setFontSize(20);
    doc.setTextColor(0, 0, 0);
    doc.text('Guide Commercial - Syst√®me de Validation', 20, 60);
    doc.text('des Bulletins S√©curis√©s 2025', 20, 72);
    
    // Badge COMMERCIAL
    doc.setFillColor(239, 68, 68); // Rouge
    doc.rect(140, 75, 35, 8, 'F');
    doc.setFontSize(10);
    doc.setTextColor(255, 255, 255);
    doc.text('COMMERCIAL', 142, 81);
    
    // M√©tadonn√©es
    doc.setFontSize(10);
    doc.setTextColor(100, 100, 100);
    doc.text(`G√©n√©r√© le: ${new Date().toLocaleDateString('fr-FR')}`, 20, 90);
    doc.text(`Version: 2025.1 - Solution Entreprise`, 20, 97);
    doc.text(`Contact: commercial@educafric.com`, 20, 104);
    
    let yPosition = 120;
    
    // Section 1: Innovation Technologique
    doc.setFontSize(16);
    doc.setTextColor(46, 134, 193);
    doc.text('üöÄ Innovation Technologique EDUCAFRIC', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const introText = [
      '‚Ä¢ Architecture de triple validation cryptographique (SHA-256)',
      '‚Ä¢ QR codes s√©curis√©s avec empreinte digitale unique',
      '‚Ä¢ Tampons num√©riques int√©gr√©s impossibles √† falsifier',
      '‚Ä¢ Validation en temps r√©el via blockchain √©ducative',
      '‚Ä¢ Certificats num√©riques avec horodatage s√©curis√©'
    ];
    
    introText.forEach(text => {
      doc.text(text, 25, yPosition);
      yPosition += 8;
    });
    
    yPosition += 10;
    
    // Section 2: Avantages Commerciaux
    doc.setFontSize(16);
    doc.setTextColor(46, 134, 193);
    doc.text('üí∞ Retour sur Investissement Garanti', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const roiText = [
      '‚Ä¢ R√©duction de 95% des co√ªts d\'impression papier',
      '‚Ä¢ √âlimination compl√®te de la falsification de bulletins',
      '‚Ä¢ Gain de temps administration: 80% d\'efficacit√© en plus',
      '‚Ä¢ Satisfaction parents: 98% de taux d\'approbation',
      '‚Ä¢ Conformit√© internationale aux standards ISO 27001'
    ];
    
    roiText.forEach(text => {
      doc.text(text, 25, yPosition);
      yPosition += 8;
    });
    
    yPosition += 15;
    
    // Section 3: Processus Technique
    doc.setFontSize(16);
    doc.setTextColor(46, 134, 193);
    doc.text('üîß Architecture du Syst√®me', 20, yPosition);
    yPosition += 15;
    
    // Nouvelle page si n√©cessaire
    if (yPosition > 250) {
      doc.addPage();
      yPosition = 30;
    }
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    const processSteps = [
      '1. G√©n√©ration automatique des bulletins avec notes saisies',
      '2. Calcul cryptographique SHA-256 de l\'empreinte unique',
      '3. Cr√©ation du QR code s√©curis√© avec m√©tadonn√©es',
      '4. Application des tampons num√©riques d\'√©cole',
      '5. Distribution automatique aux parents via SMS/Email',
      '6. Validation instantan√©e par scan QR code'
    ];
    
    processSteps.forEach(text => {
      doc.text(text, 25, yPosition);
      yPosition += 10;
    });
    
    yPosition += 15;
    
    // Section 4: Tarification
    doc.setFontSize(16);
    doc.setTextColor(5, 150, 105); // Vert
    doc.text('üíµ Tarification R√©volutionnaire', 20, yPosition);
    yPosition += 15;
    
    // Encadr√© tarification
    doc.setDrawColor(5, 150, 105);
    doc.setLineWidth(1);
    doc.rect(20, yPosition - 5, 170, 40);
    
    doc.setFontSize(14);
    doc.setTextColor(5, 150, 105);
    doc.text('EDUCAFRIC PAIE LES √âCOLES', 25, yPosition + 5);
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text('‚Ä¢ √âcoles <500 √©l√®ves: EDUCAFRIC verse 150.000 CFA/an', 25, yPosition + 15);
    doc.text('‚Ä¢ √âcoles >500 √©l√®ves: EDUCAFRIC verse 200.000 CFA/an', 25, yPosition + 25);
    
    yPosition += 50;
    
    // Section 5: Contact et Support
    doc.setFontSize(16);
    doc.setTextColor(46, 134, 193);
    doc.text('üìû Contact Commercial', 20, yPosition);
    yPosition += 15;
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text('Email: commercial@educafric.com', 25, yPosition);
    yPosition += 8;
    doc.text('T√©l√©phone: +237 657 004 011', 25, yPosition);
    yPosition += 8;
    doc.text('WhatsApp Business: +237 657 004 011', 25, yPosition);
    yPosition += 8;
    doc.text('Site Web: www.educafric.com', 25, yPosition);
    
    // Pied de page
    yPosition = 280;
    doc.setFontSize(10);
    doc.setTextColor(100, 100, 100);
    doc.text('EDUCAFRIC - Transformons l\'√©ducation africaine avec la technologie', 20, yPosition);
    doc.text('¬© 2025 Afro Metaverse Marketing SARL - Tous droits r√©serv√©s', 20, yPosition + 7);
    
    return Buffer.from(doc.output('arraybuffer'));
  }
}